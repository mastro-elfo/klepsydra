(this.webpackJsonpklepsydra=this.webpackJsonpklepsydra||[]).push([[0],{149:function(e){e.exports=JSON.parse('{"a":"1.5.2"}')},403:function(e){e.exports=JSON.parse('{"a":{}}')},430:function(e,t,n){},501:function(e,t){},507:function(e,t,n){},508:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(22),i=n.n(r),o=(n(430),n(71)),s=n.n(o),j=n(94),u=n(9),l=n(10),b=n(36),d=n(548),O=n(399),h=n.n(O),f=n(400),x=n.n(f),p=n(364),m=n(33),v=n(570),g=n(525),y=n(526),C=n(552),S=n(7),k=n(89),w=n(1);function P(e){return Object(w.jsxs)(k.a,Object(S.a)(Object(S.a)({},e),{},{children:[Object(w.jsx)("defs",{children:Object(w.jsx)("mask",{id:"mask-0",children:Object(w.jsx)("path",{style:{fill:"rgb(255, 255, 255)"},d:"M 175 0 L 325 0 C 425 0 255 200 255 250 C 255 300 425 500 325 500 L 175 500 C 75 500 245 300 245 250 C 245 200 75 0 175 0 Z",children:Object(w.jsx)("title",{children:"SandMask"})})})}),Object(w.jsxs)("g",{transform:"matrix(0.048, 0, 0, 0.048, 0.004347, -0.000001)",children:[Object(w.jsx)("path",{style:{fill:"rgb(216, 216, 216)",fillOpacity:.25},d:"M 175 0 L 325 0 C 425 0 255 200 255 250 C 255 300 425 500 325 500 L 175 500 C 75 500 245 300 245 250 C 245 200 75 0 175 0 Z",children:Object(w.jsx)("title",{children:"BackGlass"})}),Object(w.jsx)("path",{style:{fill:"rgb(255, 187, 0)",mask:"url(#mask-0)"},d:"M 175 500 C 74.558 500 240 400 250 400 C 260 400 425 500 325 500 L 175 500 Z M 350 100 C 325 125 255 260 250 260 C 245 260 175 125 150 100 C 225 125 275 125 350 100 Z",children:Object(w.jsx)("title",{children:"Sand"})}),Object(w.jsx)("path",{style:{fill:"rgb(216, 216, 216)",fillOpacity:.25},d:"M 175 0 L 325 0 C 425 0 255 200 255 250 C 255 300 425 500 325 500 L 175 500 C 75 500 245 300 245 250 C 245 200 75 0 175 0 Z",children:Object(w.jsx)("title",{children:"FrontGlass"})}),Object(w.jsx)("path",{style:{fill:"rgb(255, 255, 255)",fillOpacity:.5},d:"M 200 0 C 149.993 49.967 250 200 250 250 C 250 300 150 450 200 500 L 250 500 C 200 450 250 300 250 250 C 250 200 200.181 49.154 250 0 L 200 0 Z",children:Object(w.jsx)("title",{children:"Light"})})]})]}))}var T=n.p+"static/media/background.d22ce5ba.svg";function D(e){Object(c.useEffect)((function(){document.title=e?"Kleps\xfddra - ".concat(e):"Kleps\xfddra"}),[e])}var A=n(149);var F={path:"/about",exact:!0,component:function(){D("Informazioni");var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(v.a)().t;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),children:"Informazioni"}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:A.a,secondary:r("Version")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"Francesco Michienzi",secondary:r("Software Development")})}),Object(w.jsx)(y.a,{button:!0,onClick:function(){return a(!0)},children:Object(w.jsx)(C.a,{primary:"Copyright (c) 2021 mastro-elfo",secondary:r("MIT License")})})]}),Object(w.jsx)(l.ConfirmDialog,{open:n,onClose:function(){return a(!1)},content:["Copyright (c) 2021 mastro-elfo",'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:',"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.",'THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.'],confirm:"Letto",onConfirm:function(){return a(!1)}})]}),PaperProps:{style:{backgroundImage:"url(".concat(T,")"),backgroundSize:"auto 50%",backgroundPosition:"right bottom",backgroundRepeat:"no-repeat"}}})}},I={key:"about",primary:"About.Key",secondary:"v".concat(A.a),icon:Object(w.jsx)(P,{}),title:"$t(Open) $t(About.Key)"},E=n(39),N=n(32),_=n(27),B=n(257),R=n(416),M=n(523),L=n(45),W=n(553),H=n(550),$=n(554),K=n(386),z=n.n(K),q=n(190),U=n.n(q),G=n(191),V=n.n(G),J=n(192),Y=n.n(J);function Z(e){var t=e.contact,n=e.onChange,a=e.onDelete,r=Object(v.a)().t,i=Object(c.useState)(t),o=Object(u.a)(i,2),s=o[0],j=o[1];Object(c.useEffect)((function(){var e=setTimeout(n,100,s);return function(){return clearTimeout(e)}}),[s]);var l=s.type,b=s.value,d={email:r("Email"),link:r("Link"),phone:r("Telephone")}[l]||r("Undefined"),O=function(e){return function(t){var n=t.target.value;return j(Object(S.a)(Object(S.a)({},s),{},Object(N.a)({},e,n)))}};return Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,value:b,onChange:O("value"),label:d,InputProps:{startAdornment:Object(w.jsx)(M.a,{position:"start",children:Object(w.jsxs)(R.a,{select:!0,value:l,onChange:O("type"),InputProps:{disableUnderline:!0},children:[Object(w.jsx)($.a,{value:"email",children:Object(w.jsx)(U.a,{})}),Object(w.jsx)($.a,{value:"link",children:Object(w.jsx)(V.a,{})}),Object(w.jsxs)($.a,{value:"phone",children:[Object(w.jsx)("span",{}),Object(w.jsx)(Y.a,{})]})]})}),endAdornment:Object(w.jsx)(M.a,{position:"end",children:Object(w.jsx)(B.a,{onClick:a,children:Object(w.jsx)(z.a,{})})})}})})}var X=n(387),Q=n.n(X);function ee(e){var t=e.contact,n=Object(v.a)().t,c=t.type,a=t.value,r={email:Object(w.jsx)(U.a,{}),link:Object(w.jsx)(V.a,{}),phone:Object(w.jsx)(Y.a,{})}[c]||Object(w.jsx)(Q.a,{}),i={email:n("Email"),link:n("Link"),phone:n("Telephone")}[c]||n("Undefined");return Object(w.jsxs)(y.a,{children:[Object(w.jsx)(H.a,{children:r}),Object(w.jsx)(C.a,{primary:a,secondary:i})]})}function te(e){for(var t=Object.keys(e),n=arguments.length,c=new Array(n>1?n-1:0),a=1;a<n;a++)c[a-1]=arguments[a];var r=Object.assign.apply(Object,[e].concat(c));return Object.keys(r).filter((function(e){return-1!==t.indexOf(e)})).reduce((function(e,t){return Object(S.a)(Object(S.a)({},e),{},Object(N.a)({},t,r[t]))}),{})}var ne={id:null,type:"email",value:""};function ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return te.apply(void 0,[ne,{id:+new Date}].concat(t))}var ae=n(62),re=n.n(ae);function ie(e){var t=e.contacts,n=e.edit,a=void 0!==n&&n,r=e.onChange,i=Object(c.useState)(t),o=Object(u.a)(i,2),s=o[0],j=o[1];Object(c.useEffect)((function(){var e=setTimeout(r,100,s);return function(){return clearTimeout(e)}}),[s]);var l=function(e){return function(){var t=s.slice();t.splice(e,1),j(t)}},b=function(e){return function(t){var n=s.slice();n[e]=t,j(n)}},d=a?Z:ee;return Object(w.jsxs)(g.a,{subheader:Object(w.jsx)(W.a,{children:"Contatti"}),children:[!!a&&Object(w.jsxs)(y.a,{button:!0,onClick:function(){return j([ce()].concat(Object(L.a)(s)))},children:[Object(w.jsx)(H.a,{children:Object(w.jsx)(re.a,{})}),Object(w.jsx)(C.a,{primary:"Aggiungi"})]}),s.map((function(e,t){return Object(w.jsx)(d,{contact:e,onChange:b(t),onDelete:l(t)},e.id)}))]})}var oe={price:10,enableDiscountRound:!1,discountRound:1,currency:"\u20ac",printTitle:"",printBefore:"",printAfter:"",printNote:!0,intro:!0};function se(){try{return Object.assign(oe,JSON.parse(localStorage.getItem("settings")))}catch(e){return oe}}var je=Object(c.createContext)();function ue(){return Object(c.useContext)(je)}function le(e){var t=e.children,n=e.defaultValue,a=Object(c.useState)(Object(S.a)(Object(S.a)({},n),Object(c.useMemo)(se,[]))),r=Object(u.a)(a,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){var e;e=i,localStorage.setItem("settings",JSON.stringify(e))}),[i]),Object(w.jsx)(je.Provider,{value:[i,o],children:t})}var be=n(128),de=n(198),Oe=n(197),he=n(388),fe=n(250),xe=n(404);fe.a.plugin(xe.a);var pe=function(){function e(t,n){Object(be.a)(this,e),this._table=t,this._id=n,this._db=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new fe.a(e,t)}(t),this._indexes=[{fields:[{updatedAt:"desc"}],name:"idx_updatedAt"}]}return Object(he.a)(e,[{key:"init",value:function(){var e=Object(j.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this._indexes.map((function(e){return t._db.createIndex({index:e})}))).catch((function(e){console.error(e)})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._db.post(Object(S.a)({createdAt:new Date,updatedAt:new Date},e),t)}},{key:"read",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._db.get(this._id,e)}},{key:"update",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._db.get(this._id).then((function(c){return t._db.put(Object(S.a)(Object(S.a)({_id:t._id,_rev:c._rev},e),{},{updatedAt:new Date}),n)}))}},{key:"delete",value:function(){var e=this;return this._db.get(this._id).then((function(t){return e._db.remove(t)}))}},{key:"search",value:function(e){return this._db.find(e)}},{key:"all",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._db.allDocs(e)}}]),e}(),me=function(e){Object(de.a)(n,e);var t=Object(Oe.a)(n);function n(e){return Object(be.a)(this,n),t.call(this,"client",e)}return n}(pe),ve={_id:void 0,contacts:[],name:"",price:0,surname:""};function ge(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return te.apply(void 0,[ve].concat(t))}var ye=["_id","contacts","name","price","surname"];function Ce(){return Se.apply(this,arguments)}function Se(){return(Se=Object(j.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(new me).init());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return new me(e).read()}function we(e){var t=RegExp(e.split(" ").filter((function(e){return!!e.trim()})).map((function(e){return".*".concat(e,".*")})).join("|"),"i");return(new me).search({selector:{$or:[{name:{$regex:t}},{surname:{$regex:t}},{contacts:{$elemMatch:{value:{$regex:t}}}}]},fields:ye}).then((function(e){var t=e.docs,n=e.warning;return n&&console.warn(n),t}))}function Pe(){return(new me).search({selector:{updatedAt:{$gt:null}},fields:ye,sort:[{updatedAt:"desc"}],limit:10}).then((function(e){var t=e.docs,n=e.warning;return n&&console.warn(n),t}))}var Te=n(104),De=n.n(Te);var Ae={path:"/client/create",exact:!0,component:function(){var e,t=Object(E.k)().replace,n=Object(_.useSnackbar)().enqueueSnackbar,a=Object(E.l)().state,r=ue(),i=Object(u.a)(r,1)[0],o=Object(c.useState)(ge(Object(S.a)({price:i.price},a))),s=Object(u.a)(o,2),j=s[0],b=s[1],d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){var c=n.target.value;return b(Object(S.a)(Object(S.a)({},j),{},Object(N.a)({},e,t(c))))}},O=j.contacts,h=j.name,f=j.surname,x=j.price;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:Object(w.jsx)(B.a,{onClick:function(){var e;(e=ge(j),(new me).create(e)).then((function(e){var c=e.id;n("Documento creato",{variant:"success"}),setTimeout(t,500,"/client/view/".concat(c))})).catch((function(e){console.error(e),n("Errore",{variant:"error"})}))},children:Object(w.jsx)(De.a,{})}),children:"Crea Studente"}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Nome",value:h,onChange:d("name")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Cognome",value:f,onChange:d("surname")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Tariffa",type:"number",value:parseFloat(x||0).toFixed(2),onChange:d("price",parseFloat),InputProps:{startAdornment:Object(w.jsxs)(M.a,{position:"start",children:[i.currency,"/h"]})}})})]}),Object(w.jsx)(ie,{edit:!0,contacts:O,onChange:(e="contacts",function(t){return b(Object(S.a)(Object(S.a)({},j),{},Object(N.a)({},e,t)))})})]})})}},Fe=n(129),Ie=n.n(Fe);function Ee(e){var t=e.children,n=e.title,c=void 0===n?"Loading...":n;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(B.a,{children:Object(w.jsx)(Ie.a,{})}),children:c}),content:Object(w.jsx)(l.Content,{children:t})})}var Ne={path:"/client/edit/:id",exact:!0,component:function(){var e=Object(E.k)(),t=e.go,n=e.goBack,a=e.location,r=Object(E.m)().id,i=Object(_.useSnackbar)().enqueueSnackbar,o=Object(c.useState)(a.state),s=Object(u.a)(o,2),j=s[0],b=s[1],d=ue(),O=Object(u.a)(d,1)[0];if(Object(c.useEffect)((function(){j||ke(r).then((function(e){b(ge(e))})).catch((function(e){console.error(e),i("".concat(e.name," ").concat(e.message),{variant:"error"})}))}),[r,j]),!j)return Object(w.jsx)(Ee,{});var h,f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){var c=n.target.value;return b(Object(S.a)(Object(S.a)({},j),{},Object(N.a)({},e,t(c))))}},x=j.contacts,p=j.name,m=j.surname,v=j.price;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:Object(w.jsx)(B.a,{onClick:function(){(function(e,t){return new me(e).update(t)})(r,j).then((function(e){i("Modifiche salvate",{variant:"success"}),setTimeout(n,500)})).catch((function(e){console.error(e),i("".concat(e.name," ").concat(e.message),{variant:"error"})}))},children:Object(w.jsx)(De.a,{})}),children:"Modifica"}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Nome",value:p||"",onChange:f("name")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Cognome",value:m||"",onChange:f("surname")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:"Tariffa",type:"number",value:parseFloat(v||0).toFixed(2),onChange:f("price",parseFloat),InputProps:{startAdornment:Object(w.jsxs)(M.a,{position:"start",children:[O.currency,"/h"]})}})})]}),Object(w.jsx)(ie,{contacts:x,edit:!0,onChange:(h="contacts",function(e){return b(Object(S.a)(Object(S.a)({},j),{},Object(N.a)({},h,e)))})}),Object(w.jsx)(g.a,{children:Object(w.jsx)(y.a,{children:Object(w.jsx)(l.ConfirmDialogButton,{variant:"contained",Component:l.DangerButton,onConfirm:function(){(function(e){return new me(e).delete()})(r).then((function(e){i("Studente eliminato",{variant:"success"}),setTimeout(t,500,-2)})).catch((function(e){console.error(e),i("".concat(e.name," ").concat(e.message),{variant:"error"})}))},DialogProps:{title:"Elimina Studente",content:'Confermi di eliminare "'.concat(p," ").concat(m,'"?'),confirm:"Elimina",cancel:"Annulla"},children:"Elimina"})})})]})})}};var _e={path:"/client",exact:!0,component:function(){var e=Object(E.k)().push,t=Object(_.useSnackbar)().enqueueSnackbar,n=Object(c.useState)([]),a=Object(u.a)(n,2),r=a[0],i=a[1],o=Object(c.useState)(!1),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(v.a)().t;return Object(c.useEffect)((function(){j||(b(!0),Pe().then((function(e){return i(e)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})})))}),[j]),Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:[Object(w.jsx)(l.BackIconButton,{},"back"),Object(w.jsx)(l.HeaderSearchField,{fullWidth:!0,placeholder:d("Client.Search"),onSearch:function(e,n){""===n?b(!1):(b(!0),we(n).then((function(e){return i(e)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})})))},onClear:function(){b(!1)}},"search")],rightAction:Object(w.jsx)(l.Push,{href:"/client/create",children:Object(w.jsx)(B.a,{children:Object(w.jsx)(re.a,{})})},"create")}),content:Object(w.jsx)(l.Content,{children:Object(w.jsx)(g.a,{children:r.map((function(t){var n=t._id,c=t.name,a=t.surname,r=t.contacts;return Object(w.jsx)(y.a,{button:!0,onClick:function(){return e("/client/view/".concat(n))},children:Object(w.jsx)(C.a,{primary:"".concat(c," ").concat(a),secondary:"".concat(r&&r.length?r[0].value:"")})},n)}))})})})}},Be=n(563);function Re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return n.reduce((function(e,t){var n=t.start,c=t.end;return e-(c?new Date(c)-new Date(n):0)}),new Date(t)-new Date(e))}function Me(e){try{return new Date(e).toISOString().substr(11,8)}catch(t){return"00:00:00"}}function Le(e,t){return e<=t?0:e%t}var We=function(e){Object(de.a)(n,e);var t=Object(Oe.a)(n);function n(e){var c;return Object(be.a)(this,n),(c=t.call(this,"performance",e))._indexes.push({fields:[{start:"desc"}],name:"idx_start"}),c}return n}(pe),He={_id:void 0,client:null,discount:0,end:null,note:"",pauses:[],payed:!1,payments:[],price:0,start:null};function $e(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return te.apply(void 0,[He].concat(t))}function Ke(e){var t=e.discount,n=e.end,c=e.pauses,a=e.payments,r=e.price,i=Re(e.start,n,c),o=i/1e3/3600*r,s=o-t,j=(a||[]).reduce((function(e,t){return e+t.value}),0);return{balance:j,cost:o,due:s-j,length:i,total:s}}var ze=["_id","client","discount","end","note","pauses","payed","payments","price","start"];function qe(){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(j.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(new We).init());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(e,t){return new We(e).update(t)}function Ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fromDate,c=void 0===n?null:n,a=t.toDate,r=void 0===a?null:a,i=t.notPayed,o=void 0!==i&&i,s=t.skip,j=void 0===s?0:s,u=RegExp(e.split(" ").map((function(e){return".*".concat(e,".*")})).join("|"),"i");return(new We).search({selector:{$and:[{start:{$gte:c?c.toISOString():null,$lte:r?r.toISOString():(new Date).toISOString()}},o?{payed:!1}:{payed:{$gte:null}},{$or:[{"client.name":{$regex:u}},{"client.surname":{$regex:u}}]}]},fields:ze,sort:[{start:"desc"}],limit:10,skip:j}).then((function(e){var t=e.docs,n=e.warning;return n&&console.warn(n),t}))}function Je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.client_id,n=void 0===t?null:t,c=e.fromDate,a=void 0===c?null:c,r=e.toDate,i=void 0===r?null:r,o=e.notPayed,s=void 0!==o&&o,j=e.skip,u=void 0===j?0:j;return(new We).search({selector:{$and:[{start:{$gte:a?a.toISOString():null,$lte:i?i.toISOString():(new Date).toISOString()}},s?{payed:!1}:{payed:{$gte:null}},n?{"client._id":n}:{}]},fields:ze,sort:[{start:"desc"}],limit:10,skip:u}).then((function(e){var t=e.docs,n=e.warning;return n&&console.warn(n),t}))}var Ye=n(87),Ze=n.n(Ye);function Xe(e){var t=e.id,n=Object(_.useSnackbar)().enqueueSnackbar,a=Object(c.useState)(),r=Object(u.a)(a,2),i=r[0],o=r[1];return Object(c.useEffect)((function(){Je({client_id:t}).then((function(e){return o(e)})).catch((function(e){console.error(e),n("".concat(e.name," ").concat(e.message),{variant:"error"})}))}),[t]),i?Object(w.jsx)(g.a,{subheader:Object(w.jsxs)(W.a,{children:["Ultime prestazioni (",i.length,")"]}),children:i.map((function(e){var t=e._id,n=e.note,c=e.payed,a=e.start;return Object(w.jsx)(l.Push,{href:"/performance/view/".concat(t),children:Object(w.jsxs)(y.a,{button:!0,children:[Object(w.jsx)(H.a,{children:!!c&&Object(w.jsx)(Ze.a,{color:"secondary"})}),Object(w.jsx)(C.a,{primary:n,secondary:new Date(a).toLocaleString()})]})},t)}))}):Object(w.jsx)(g.a,{children:Array(10).fill(!0).map((function(e,t){return Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:Object(w.jsx)(Be.a,{}),secondary:Object(w.jsx)(Be.a,{})})},t)}))})}var Qe=n(86),et=n.n(Qe),tt=n(107),nt=n.n(tt);var ct={path:"/client/view/:id",exact:!0,component:function(){var e=Object(E.m)().id,t=Object(E.k)().replace,n=Object(_.useSnackbar)().enqueueSnackbar,a=Object(c.useState)(),r=Object(u.a)(a,2),i=r[0],o=r[1],s=ue(),j=Object(u.a)(s,1)[0];if(Object(c.useEffect)((function(){ke(e).then((function(e){o(ge(e))})).catch((function(e){console.error(e),n("Errore caricamento dati",{variant:"error"}),setTimeout(t,5e3,"/notfound")}))}),[e]),!i)return Object(w.jsx)(Ee,{});var b=i._id,d=i.contacts,O=i.createdAt,h=i.updatedAt,f=i.name,x=i.surname,p=i.price;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:[Object(w.jsx)(l.Push,{href:"/client/edit/".concat(b),state:i,children:Object(w.jsx)(B.a,{children:Object(w.jsx)(et.a,{})})},"edit"),Object(w.jsx)(l.Push,{href:"/tracker",state:{client:i},children:Object(w.jsx)(B.a,{disabled:!i,children:Object(w.jsx)(nt.a,{})})},"play")],children:f||x?"".concat(f," ").concat(x):"Scheda cliente"}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:f,secondary:"Nome"})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:x,secondary:"Cognome"})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(p).toFixed(2)," ").concat(j.currency,"/h"),secondary:"Tariffa"})})]}),Object(w.jsx)(ie,{contacts:d}),Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:new Date(O).toLocaleString(),secondary:"Creato"})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:new Date(h).toLocaleString(),secondary:"Aggiornato"})})]}),Object(w.jsx)(Xe,{id:e})]})})}},at=n(193),rt=n.n(at);var it={path:"/client",component:function(){return D("Clienti"),Object(w.jsxs)(E.g,{children:[Object(w.jsx)(E.d,Object(S.a)({},Ae)),Object(w.jsx)(E.d,Object(S.a)({},Ne)),Object(w.jsx)(E.d,Object(S.a)({},_e)),Object(w.jsx)(E.d,Object(S.a)({},ct)),Object(w.jsx)(E.c,{to:"/notfound"})]})}},ot={key:"client",primary:"Client.Key_plural",secondary:"",icon:Object(w.jsx)(rt.a,{}),title:"$t(Open) $t(Client.Key_plural)"},st=n(58),jt=n(195),ut=n.n(jt),lt=n(551),bt=n(564),dt=n(565),Ot=n(53),ht=n(514),ft=n(546),xt=n(517),pt=n(516),mt=n(389),vt=n.n(mt);n(507);function gt(e){return Object(w.jsx)(vt.a,Object(S.a)({},e))}function yt(e){var t=e.children,n=e.title,c=void 0===n?"":n,a=e.PickerProps,r=void 0===a?{}:a,i=Object(Ot.a)(e,["children","title","PickerProps"]);return Object(w.jsxs)(ht.a,Object(S.a)(Object(S.a)({},i),{},{children:[Object(w.jsx)(ft.a,{children:c}),Object(w.jsx)(xt.a,{children:Object(w.jsx)(gt,Object(S.a)({},r))}),Object(w.jsx)(pt.a,{children:t})]}))}var Ct=n(153),St=n(390),kt=n.n(St);function wt(e){var t=e.value,n=e.onChange,a=void 0===n?function(){}:n,r=Object(Ot.a)(e,["value","onChange"]),i=Object(c.useMemo)((function(){return{seconds:Math.floor(t/1e3)%60,minutes:Math.floor(t/6e4)%60,hours:Math.floor(t/36e5)}}),[t]),o=Object(c.useState)(!1),s=Object(u.a)(o,2),j=s[0],l=s[1],b=Object(c.useState)(i),d=Object(u.a)(b,2),O=d[0],h=d[1],f=Object(c.useState)(""),x=Object(u.a)(f,2),p=x[0],m=x[1];Object(c.useEffect)((function(){var e=i.hours,t=i.minutes,n=i.seconds,c=String(e).padStart(2,"0"),a=String(t).padStart(2,"0"),r=String(n).padStart(2,"0");m("".concat(c,":").concat(a,":").concat(r))}),[i]);var g=Object(v.a)().t,y=Object(c.useCallback)((function(){var e=O.hours,t=O.minutes,n=O.seconds;a(1e3*(3600*e+60*t+n)),l(!1)}),[O]);Object(c.useEffect)((function(){h(i)}),[i]);var C=Object(c.useCallback)((function(e){var t=e.target.value;m(t);var n=t.split(":"),c=Object(u.a)(n,3),r=c[0],i=c[1],o=c[2];r&&i&&o&&a(1e3*(3600*parseInt(r.substr(0,2))+60*parseInt(i.substr(0,2))+parseInt(o.substr(0,2))))}),[]);return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(R.a,Object(S.a)({value:p,onChange:C,InputProps:{endAdornment:Object(w.jsx)(M.a,{position:"end",children:Object(w.jsx)(B.a,{onClick:function(){return l(!0)},children:Object(w.jsx)(kt.a,{})})})}},r)),Object(w.jsxs)(yt,{open:j,onClose:function(){return l(!1)},PickerProps:{onChange:function(e){return h(e)},initialDuration:i},children:[Object(w.jsx)(Ct.a,{onClick:y,children:g("Ok")}),Object(w.jsx)(Ct.a,{onClick:function(){return l(!1)},children:g("Cancel")})]})]})}var Pt=n(194),Tt=n.n(Pt);function Dt(e){var t=e.pause,n=e.onChange,a=e.onDelete,r=Object(c.useState)(!1),i=Object(u.a)(r,2),o=i[0],s=i[1],j=Object(c.useState)(t),b=Object(u.a)(j,2),d=b[0],O=b[1];Object(c.useEffect)((function(){var e=setTimeout(n,250,d);return function(){return clearTimeout(e)}}),[d]);var h,f=d.note,x=d.start,p=d.end,m=Re(x,p),v=function(e){return O(Object(S.a)(Object(S.a)({},d),{},{start:e,end:new Date(+new Date(p)+(new Date(e)-new Date(x)))}))};return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:Me(m),value:f,onChange:(h="note",function(e){var t=e.target.value,n=Object(S.a)(Object(S.a)({},d),{},Object(N.a)({},h,t));O(n)}),InputProps:{endAdornment:Object(w.jsx)(M.a,{children:Object(w.jsx)(B.a,{onClick:function(){return s(!0)},children:Object(w.jsx)(et.a,{})})})}})}),Object(w.jsxs)(ht.a,{open:o,onClose:function(){return s(!1)},children:[Object(w.jsx)(ft.a,{children:"Modifica pausa"}),Object(w.jsx)(xt.a,{children:Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(bt.a,{fullWidth:!0,label:"Data di inizio",value:x,onChange:v,format:"dd/MM/yyyy"})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(dt.a,{fullWidth:!0,ampm:!1,label:"Ora di inizio",value:x,onChange:v,views:["hours","minutes","seconds"],keyboardIcon:Object(w.jsx)(Tt.a,{}),format:"HH:mm:ss"})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(wt,{fullWidth:!0,label:"Durata",value:m,onChange:function(e){return O(Object(S.a)(Object(S.a)({},d),{},{end:new Date(+new Date(p)+(e-m))}))}})})]})}),Object(w.jsx)(pt.a,{children:Object(w.jsx)(l.DangerButton,{onClick:function(){a(),s(!1)},children:"Elimina"})})]})]})}var At={id:null,start:null,end:null,note:""};function Ft(){for(var e=new Date,t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return te.apply(void 0,[At,{id:+e,start:e,end:e}].concat(n))}function It(e){var t=e.pauses,n=e.onChange,a=Object(c.useState)(t),r=Object(u.a)(a,2),i=r[0],o=r[1];Object(c.useEffect)((function(){var e=setTimeout(n,250,i);return function(){return clearTimeout(e)}}),[i]);var s=function(e){return function(){var t=i.slice();t.splice(e,1),o(t)}};return Object(w.jsxs)(g.a,{subheader:Object(w.jsx)(W.a,{children:"Pause"}),children:[Object(w.jsxs)(y.a,{button:!0,onClick:function(){return o([Ft()].concat(Object(L.a)(i)))},children:[Object(w.jsx)(H.a,{children:Object(w.jsx)(re.a,{})}),Object(w.jsx)(C.a,{primary:"Aggiungi"})]}),i.map((function(e,t){var n,c=e.id,a=Object(Ot.a)(e,["id"]);return Object(w.jsx)(Dt,{pause:Object(S.a)({id:c},a),onChange:(n=t,function(e){var t=i.slice();t[n]=e,o(t)}),onDelete:s(t)},c)}))]})}var Et=n(566);function Nt(e){var t=e.payment,n=e.onChange,a=e.onDelete,r=ue(),i=Object(u.a)(r,1)[0],o=Object(c.useState)(!1),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(c.useState)(t),O=Object(u.a)(d,2),h=O[0],f=O[1];Object(c.useEffect)((function(){var e=setTimeout(n,250,h);return function(){return clearTimeout(e)}}),[h]);var x,p=h.date,m=h.value;return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,type:"number",label:new Date(p).toLocaleString(),value:parseFloat(m).toFixed(2),onChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){var c=n.target.value;f(Object(S.a)(Object(S.a)({},h),{},Object(N.a)({},e,t(c))))}}("value",parseFloat),InputProps:{startAdornment:Object(w.jsx)(M.a,{position:"start",children:i.currency}),endAdornment:Object(w.jsx)(M.a,{position:"end",children:Object(w.jsx)(B.a,{onClick:function(){return b(!0)},children:Object(w.jsx)(et.a,{})})})}})}),Object(w.jsxs)(ht.a,{open:j,onClose:function(){return b(!1)},children:[Object(w.jsx)(ft.a,{children:"Modifica pagamento"}),Object(w.jsx)(xt.a,{children:Object(w.jsx)(g.a,{children:Object(w.jsx)(y.a,{children:Object(w.jsx)(Et.a,{fullWidth:!0,ampm:!1,label:"Data e Ora",value:p,onChange:(x="date",function(e){f(Object(S.a)(Object(S.a)({},h),{},Object(N.a)({},x,e)))}),format:"dd/MM/yyyy HH:mm"})})})}),Object(w.jsx)(pt.a,{children:Object(w.jsx)(l.DangerButton,{onClick:function(){a(),b(!1)},children:"Elimina"})})]})]})}var _t={id:null,date:null,value:0};function Bt(){for(var e=new Date,t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return te.apply(void 0,[_t,{id:e,date:e}].concat(n))}function Rt(e){var t=e.due,n=e.payments,a=e.onChange,r=Object(c.useState)(n),i=Object(u.a)(r,2),o=i[0],s=i[1];Object(c.useEffect)((function(){n.length>o.length&&s(n)}),[n]),Object(c.useEffect)((function(){var e=setTimeout(a,250,o);return function(){return clearTimeout(e)}}),[o]);var j=function(e){return function(){var t=o.slice();t.splice(e,1),s(t)}};return Object(w.jsxs)(g.a,{subheader:Object(w.jsx)(W.a,{children:"Pagamenti"}),children:[Object(w.jsxs)(y.a,{button:!0,onClick:function(){return s([Bt({value:t})].concat(Object(L.a)(o)))},children:[Object(w.jsx)(H.a,{children:Object(w.jsx)(re.a,{})}),Object(w.jsx)(C.a,{primary:"Aggiungi"})]}),o.map((function(e,t){var n,c=e.id,a=Object(Ot.a)(e,["id"]);return Object(w.jsx)(Nt,{payment:Object(S.a)({id:c},a),onChange:(n=t,function(e){var t=o.slice();t[n]=e,s(t)}),onDelete:j(t)},c)}))]})}function Mt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Math.abs(t-e)<Math.pow(10,-n)/2}var Lt=n(391),Wt=n.n(Lt),Ht=n(252),$t=n.n(Ht);var Kt={path:"/performance/edit/:id",exact:!0,component:function(){var e=Object(v.a)().t,t=ue(),n=Object(u.a)(t,1)[0],a=Object(E.k)(),r=a.go,i=a.goBack,o=a.location,s=Object(E.m)().id,j=Object(_.useSnackbar)().enqueueSnackbar,b=Object(c.useState)(o.state),d=Object(u.a)(b,2),O=d[0],h=d[1],f=O.start,x=O.end,p=O.price,m=O.discount,k=O.pauses,P=O.note,T=O.payments,D=O.client,A=D.name,F=D.surname,I=Re(f,x,k),W=I/1e3/3600*p,H=W-m,$=T.reduce((function(e,t){var n=t.value;return e+parseFloat(n)}),0),K=H-$,z=Mt(K,0),q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){var c=n.target.value;return h(Object(S.a)(Object(S.a)({},O),{},Object(N.a)({},e,t(c))))}},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){return h(Object(S.a)(Object(S.a)({},O),{},Object(N.a)({},e,t(n))))}},G=function(e){return h(Object(S.a)(Object(S.a)({},O),{},{start:e,end:new Date(+new Date(x)+(new Date(e)-new Date(f)))}))};return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:Object(w.jsx)(B.a,{onClick:function(){if(isNaN(p)||p<0)return j(e("Performance.Snackbar.InvalidPrice"),{variant:"warning"});Ge(s,Object(S.a)(Object(S.a)({},O),{},{payed:z})).then((function(t){j(e("Performance.Snackbar.ChangesSaved"),{variant:"success"}),setTimeout(i,500)})).catch((function(e){console.error(e),j("".concat(e.name," ").concat(e.message),{variant:"error"})}))},children:Object(w.jsx)(De.a,{})}),children:"Modifica"}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsxs)(y.a,{children:[Object(w.jsx)(C.a,{primary:"".concat(A," ").concat(F),secondary:e("Client.Key")})," ",Object(w.jsx)(lt.a,{children:Object(w.jsx)(B.a,{onClick:function(){return ke(D._id).then((function(e){h(Object(S.a)(Object(S.a)({},O),{},{client:e}))})).catch((function(e){console.error(e),j("".concat(e.name," ").concat(e.message),{variant:"error"})}))},children:Object(w.jsx)($t.a,{})})})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(C.a,{primary:"".concat($.toFixed(2)," ").concat(n.currency),secondary:e("Performance.Balance")}),Object(w.jsx)(lt.a,{children:Object(w.jsx)(B.a,{onClick:function(){var e=new Date;h(Object(S.a)(Object(S.a)({},O),{},{payments:[{id:e,date:e,value:K}].concat(Object(L.a)(O.payments))}))},disabled:z,children:Object(w.jsx)(Wt.a,{})})})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(bt.a,{fullWidth:!0,label:e("Performance.StartDate"),value:f,onChange:G,format:"dd/MM/yyyy"}),Object(w.jsx)(dt.a,{fullWidth:!0,ampm:!1,label:e("Performance.StartHour"),value:f,onChange:G,views:["hours","minutes","seconds"],keyboardIcon:Object(w.jsx)(Tt.a,{}),format:"HH:mm:ss"})]}),Object(w.jsx)(y.a,{children:Object(w.jsx)(wt,{fullWidth:!0,label:e("Performance.Length"),value:I,onChange:function(e){return h(Object(S.a)(Object(S.a)({},O),{},{end:new Date(+new Date(x)+(e-I))}))}})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:e("Performance.Price"),type:"number",value:parseFloat(p||0).toFixed(2),onChange:q("price",parseFloat),InputProps:{startAdornment:Object(w.jsxs)(M.a,{position:"start",children:[n.currency,"/h"]})},inputProps:{min:0}})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(W||0).toFixed(2)," ").concat(n.currency),secondary:e("Performance.Cost")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,label:e("Performance.Discount"),type:"number",value:parseFloat(m||0).toFixed(2),onChange:q("discount",parseFloat),InputProps:{startAdornment:Object(w.jsx)(M.a,{position:"start",children:n.currency}),endAdornment:Object(w.jsx)(M.a,{position:"end",children:Object(w.jsx)(B.a,{onClick:q("discount",(function(){return Le(W,n.discountRound)})),children:Object(w.jsx)($t.a,{})})})},inputProps:{min:0}})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(H||0).toFixed(2)," ").concat(n.currency),secondary:e("Performance.Total")})}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,multiline:!0,variant:"outlined",label:e("Performance.Notes"),rows:2,rowsMax:4,value:P,onChange:q("note")})})]}),Object(w.jsx)(It,{pauses:k,onChange:U("pauses")}),Object(w.jsx)(Rt,{due:K,payments:T,onChange:U("payments")}),Object(w.jsx)(g.a,{children:Object(w.jsx)(y.a,{children:Object(w.jsx)(l.ConfirmDialogButton,{variant:"contained",Component:l.DangerButton,onConfirm:function(){(function(e){return new We(e).delete()})(s).then((function(t){j(e("Performance.Snackbar.PerformanceDeleted"),{variant:"success"}),setTimeout(r,500,-2)})).catch((function(e){console.error(e),j("".concat(e.name," ").concat(e.message),{variant:"error"})}))},DialogProps:{title:e("Performance.Delete"),content:e("Performance.Confirm delete performance"),confirm:e("Delete"),cancel:e("Cancel")},children:e("Delete")})})})]})})}},zt=n(567),qt=n(237),Ut=n(256),Gt=n(202),Vt=n(392);function Jt(){return Object(w.jsx)(Ee,{children:Object(w.jsx)(g.a,{children:Object(w.jsx)(l.For,{each:Array(10).fill(!0),Component:function(){return Object(w.jsxs)(y.a,{children:[Object(w.jsx)(H.a,{children:Object(w.jsx)(Be.a,{variant:"circle",width:20,heigth:20})}),Object(w.jsx)(C.a,{primary:Object(w.jsxs)(Gt.a,{container:!0,children:[Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(st.a,{variant:"h6",children:Object(w.jsx)(Be.a,{width:"75%"})})}),Object(w.jsx)(Gt.a,{item:!0,xs:6,sm:4,children:Object(w.jsx)(C.a,{primary:Object(w.jsx)(Be.a,{width:"75%"}),secondary:Object(w.jsx)(Be.a,{width:"65%"})})}),Object(w.jsx)(Gt.a,{item:!0,xs:6,sm:4,children:Object(w.jsx)(C.a,{primary:Object(w.jsx)(Be.a,{width:"75%"}),secondary:Object(w.jsx)(Be.a,{width:"65%"})})})]}),secondary:Object(w.jsx)(Be.a,{})}),Object(w.jsx)(lt.a,{children:Object(w.jsx)(Be.a,{variant:"circle",width:20,heigth:20})})]})}})})})}var Yt=n(393),Zt=n.n(Yt);function Xt(e){var t=e.selected,n=e.onUpdate,a=Object(_.useSnackbar)().enqueueSnackbar,r=ue(),i=Object(u.a)(r,1)[0],o=Object(c.useState)(!1),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(c.useMemo)((function(){return t.map((function(e){return Ke(e)})).reduce((function(e,t){return e+t.due}),0)}),[t]);return Object(w.jsx)(l.ConfirmDialogButton,{Component:B.a,open:j,onClose:function(){return b(!1)},onCancel:function(){return b(!1)},onConfirm:function(){Promise.all(t.map((function(e){var t=Ke(e).due;return Mt(t,0)?null:$e(e,{payed:!0,payments:[].concat(Object(L.a)(e.payments),[Bt({value:t})])})})).filter((function(e){return!!e})).map((function(e){return Ge(e._id,e)}))).then((function(){a("Pagamenti effettuati",{variant:"success"}),n()})).catch((function(e){console.error(e),a("".concat(e.name," ").concat(e.message),{variant:"error"})}))},disabled:0===t.length,DialogProps:{title:"Conferma il pagamento",confirm:"Conferma",cancel:"Annulla",content:[Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"".concat(d.toFixed(2)).concat(i.currency),secondary:"Totale"})},"first")].concat(Object(L.a)(t.map((function(e){var t=Ke(e).due;return Object(w.jsxs)(y.a,{children:[Object(w.jsx)(C.a,{primary:"".concat(e.client.name," ").concat(e.client.surname),secondary:"".concat(new Date(e.start).toLocaleString()," ").concat(e.note)}),Object(w.jsx)(C.a,{primary:"".concat(t.toFixed(2)).concat(i.currency)})]},e._id)}))))},children:Object(w.jsx)(Zt.a,{})})}function Qt(e){var t=e.checked,n=e.onClick,c=e.onToggle,a=e.performance,r=Object(v.a)().t,i=ue(),o=Object(u.a)(i,1)[0],s=a.client,j=s.name,l=s.surname,b=a.discount,d=a.end,O=a.note,h=a.pauses,f=a.payed,x=a.payments,p=a.price,m=a.start,g=Re(m,d,h)/1e3/3600*p-b-x.reduce((function(e,t){return e+t.value}),0);return Object(w.jsxs)(y.a,{button:!0,onClick:n,children:[Object(w.jsx)(H.a,{children:f?Object(w.jsx)(Ze.a,{color:"secondary"}):Object(w.jsx)("span",{})}),Object(w.jsx)(C.a,{primary:Object(w.jsxs)(Gt.a,{container:!0,children:[Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:3,children:Object(w.jsxs)(st.a,{variant:"h6",children:[j," ",l]})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,children:Object(w.jsx)(C.a,{primary:new Date(m).toLocaleString(),secondary:r("Date")})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,children:Object(w.jsx)(C.a,{primary:Me(Re(m,d,h)),secondary:r("Duration")})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(g).toFixed(2)," ").concat(o.currency),secondary:r("Due")})})]}),secondary:O}),Object(w.jsx)(lt.a,{children:Object(w.jsx)(zt.a,{checked:t,onChange:c})})]})}var en=n(547),tn=n(143),nn=n.n(tn);function cn(e){var t=e.onPrint,n=void 0===t?function(){}:t,a=Object(Ot.a)(e,["onPrint"]),r=ue(),i=Object(u.a)(r,1)[0],o=Object(c.useState)(i.printTitle),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(c.useState)(i.printBefore),O=Object(u.a)(d,2),h=O[0],f=O[1],x=Object(c.useState)(i.printAfter),p=Object(u.a)(x,2),m=p[0],v=p[1],g=Object(c.useState)(i.printNote),y=Object(u.a)(g,2),C=y[0],k=y[1];return Object(w.jsx)(l.ConfirmDialogButton,Object(S.a)(Object(S.a)({isIcon:!0,DialogProps:{title:"Print document",confirm:"Print",cancel:"Cancel",content:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(R.a,{fullWidth:!0,label:"Title",value:j,onChange:function(e){var t=e.target.value;return b(t)}},"title"),Object(w.jsx)(R.a,{fullWidth:!0,multiline:!0,rows:2,rowsMax:4,label:"Before",value:h,onChange:function(e){var t=e.target.value;return f(t)}},"before"),Object(w.jsx)(R.a,{fullWidth:!0,multiline:!0,rows:2,rowsMax:4,label:"After",value:m,onChange:function(e){var t=e.target.value;return v(t)}},"after"),Object(w.jsx)(en.a,{control:Object(w.jsx)(zt.a,{checked:C,onChange:function(){return k(!C)}}),label:"Print note"})]})},onConfirm:function(){setTimeout(n,225,{printTitle:j,printBefore:h,printAfter:m,printNote:C})},onOpen:function(){b(i.printTitle),f(i.printBefore),v(i.printAfter)}},a),{},{children:Object(w.jsx)(nn.a,{})}))}var an=n(5),rn=n(557),on=n(555),sn=n(559),jn=n(560),un=n(558),ln=n(556),bn=n(327);function dn(e){var t=e.list,n=void 0===t?[]:t,a=e.printTitle,r=void 0===a?"":a,i=e.printBefore,o=void 0===i?"":i,s=e.printAfter,j=void 0===s?"":s,b=e.printNote,d=void 0!==b&&b,O=ue(),h=Object(u.a)(O,1)[0],f=n.map((function(e){var t=e.start,n=e.end,c=e.pauses,a=e.price;return Re(t,n,c)/1e3/3600*a})).reduce((function(e,t){return e+t}),0),x=n.map((function(e){return e.discount})).reduce((function(e,t){return e+t}),0),p=f-x,m=p-n.map((function(e){return e.payments.reduce((function(e,t){return e+t.value}),0)})).reduce((function(e,t){return e+t}),0),v=n.every((function(e){return!!e.payed}));return Object(w.jsxs)(c.Fragment,{children:[!!r&&Object(w.jsx)(st.a,{variant:"h4",gutterBottom:!0,children:r}),!!o&&o.split("\n").map((function(e,t){return Object(w.jsx)(st.a,{variant:"body2",children:e},t)})),!!o&&Object(w.jsx)(st.a,{variant:"body2",gutterBottom:!0}),Object(w.jsx)(rn.a,{children:Object(w.jsxs)(on.a,{children:[Object(w.jsx)(sn.a,{children:Object(w.jsxs)(jn.a,{children:[Object(w.jsx)(l.TableHeadCell,{children:"Data e Ora"}),Object(w.jsx)(l.TableHeadCell,{children:"Durata"}),Object(w.jsxs)(l.TableHeadCell,{children:["Prezzo ",h.currency,"/h"]}),Object(w.jsxs)(l.TableHeadCell,{children:["Costo ",h.currency]}),Object(w.jsxs)(l.TableHeadCell,{children:["Sconto ",h.currency]}),Object(w.jsxs)(l.TableHeadCell,{children:["Tot. ",h.currency]})]})}),Object(w.jsx)(un.a,{}),Object(w.jsxs)(ln.a,{children:[n.map((function(e){var t=e._id,n=Object(Ot.a)(e,["_id"]);return Object(w.jsx)(hn,Object(S.a)({printNote:d},n),t)})),Object(w.jsxs)(jn.a,{children:[Object(w.jsx)(On,{colSpan:3,children:Object(w.jsx)(st.a,{variant:"button",display:"block",align:"right",children:"Totale"})}),Object(w.jsx)(On,{children:f.toFixed(2)}),Object(w.jsx)(On,{children:x.toFixed(2)}),Object(w.jsx)(On,{children:p.toFixed(2)})]}),Object(w.jsxs)(jn.a,{children:[Object(w.jsx)(bn.a,{colSpan:5,children:Object(w.jsx)(st.a,{variant:"button",display:"block",align:"right",color:v?"default":"secondary",children:v?"Pagato":"Da Pagare"})}),Object(w.jsx)(bn.a,{children:v?Object(w.jsx)(Ze.a,{color:"secondary"}):Object(w.jsx)(st.a,{color:"secondary",variant:"body2",children:m.toFixed(2)})})]})]})]})}),!!j&&Object(w.jsx)(st.a,{variant:"body2",gutterBottom:!0}),!!j&&j.split("\n").map((function(e,t){return Object(w.jsx)(st.a,{variant:"body2",children:e},t)}))]})}var On=Object(an.a)({root:{borderBottom:"none"}})(bn.a);function hn(e){var t=e.client,n=(t.name,t.surname,e.discount),a=e.end,r=e.note,i=e.pauses,o=e.payed,s=e.payments,j=e.price,u=e.start,l=e.printNote,b=void 0!==l&&l,d=Re(u,a,i),O=d/1e3/3600*j,h=O-n,f=h-s.reduce((function(e,t){return e+t.value}),0);return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsxs)(jn.a,{children:[Object(w.jsx)(On,{children:new Date(u).toLocaleString()}),Object(w.jsx)(On,{children:Me(d)}),Object(w.jsx)(On,{children:j.toFixed(2)}),Object(w.jsx)(On,{children:O.toFixed(2)}),Object(w.jsx)(On,{children:n.toFixed(2)}),Object(w.jsx)(On,{children:h.toFixed(2)})]}),Object(w.jsxs)(jn.a,{children:[Object(w.jsx)(bn.a,{colSpan:3,children:Object(w.jsx)(st.a,{variant:"body2",color:"textSecondary",children:b?r:""})}),Object(w.jsx)(bn.a,{colSpan:2,children:Object(w.jsx)(st.a,{variant:"button",display:"block",align:"right",color:o?"default":"secondary",children:o?"Pagato":"Da Pagare"})}),Object(w.jsx)(bn.a,{children:o?Object(w.jsx)(Ze.a,{color:"secondary"}):Object(w.jsx)(st.a,{color:o?"default":"secondary",variant:"body2",children:f.toFixed(2)})})]})]},u)}var fn=n(395),xn=n.n(fn),pn=n(394),mn=n.n(pn);var vn={path:"/performance",exact:!0,component:function(){var e=Object(_.useSnackbar)().enqueueSnackbar,t=ue(),n=Object(u.a)(t,1)[0],a=Object(c.useState)(),r=Object(u.a)(a,2),i=r[0],o=r[1],s=Object(c.useState)([]),j=Object(u.a)(s,2),b=j[0],d=j[1],O=Object(c.useState)(""),h=Object(u.a)(O,2),f=h[0],x=h[1],p=Object(c.useState)(!1),m=Object(u.a)(p,2),k=m[0],P=m[1],T=Object(c.useState)(n),D=Object(u.a)(T,2),A=D[0],F=D[1],I=Object(c.useState)(null),E=Object(u.a)(I,2),N=E[0],R=E[1],M=Object(c.useState)(null),W=Object(u.a)(M,2),$=W[0],K=W[1],z=Object(c.useState)(!1),q=Object(u.a)(z,2),U=q[0],G=q[1],V=Object(c.useState)(0),J=Object(u.a)(V,2),Y=J[0],Z=J[1],X=Object(v.a)().t;Object(c.useEffect)((function(){return Z((function(){return 0}))}),[f,N,$,U]),Object(c.useEffect)((function(){f||Je({fromDate:N,toDate:$,notPayed:U,skip:Y}).then((function(e){o(0===Y?e:[].concat(Object(L.a)(i),Object(L.a)(e)))})).catch((function(t){console.error(t),e("".concat(t.name," ").concat(t.message),{variant:"error"})}))}),[f,N,$,U,Y]),Object(c.useEffect)((function(){f&&Ve(f,{fromDate:N,toDate:$,notPayed:U,skip:Y}).then((function(e){o(0===Y?e:[].concat(Object(L.a)(i),Object(L.a)(e)))})).catch((function(t){console.error(t),e("".concat(t.name," ").concat(t.message),{variant:"error"})}))}),[f,N,$,U,Y]),Object(c.useEffect)((function(){var e=b.slice().filter((function(e){var t=e._id;return i.find((function(e){return e._id===t}))}));d(e)}),[i]),Object(c.useEffect)((function(){if(k){var e=setTimeout((function(){window.print(),P(!1)}),225);return function(){return clearTimeout(e)}}}),[k]);var Q=Object(c.useMemo)((function(){return b.map((function(e){return Ke(e)})).reduce((function(e,t){return e+t.due}),0)}),[b]);if(!i)return Object(w.jsx)(Jt,{});var ee=function(e){return function(){var t=b.findIndex((function(t){return t._id===e._id}));if(-1===t)d([].concat(Object(L.a)(b),[e]));else{var n=b.slice();n.splice(t,1),d(n)}}};return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:[Object(w.jsx)(l.BackIconButton,{},"back"),Object(w.jsx)(l.HeaderSearchField,{fullWidth:!0,placeholder:X("Performance.Search"),onSearch:function(e,t){x(""===t?"":t)},onClear:function(){x("")}},"search")],rightAction:[Object(w.jsx)(l.Push,{replace:!0,href:"/tracker",children:Object(w.jsx)(B.a,{disabled:0!==b.length,children:Object(w.jsx)(re.a,{})})},"create"),Object(w.jsx)(Xt,{selected:b,onUpdate:function(){var e=i.map((function(e){return b.find((function(t){return t._id===e._id}))?Object(S.a)(Object(S.a)({},e),{},{payed:!0}):e}));o(e)}},"pay"),Object(w.jsx)(cn,{disabled:0===b.length,onPrint:function(e){P(!0),F(e)}},"print"),Object(w.jsx)(zt.a,{checked:i.length>0&&i.length===b.length,indeterminate:b.length>0&&b.length<i.length,onChange:function(){b.length===i.length?d([]):d(i.slice())},disabled:0===i.length},"select")],children:Object(w.jsxs)(qt.a,{ml:1,children:[X("Performance.Total"),": ",Q.toFixed(2),n.currency]})}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsx)(Ut.a,{children:Object(w.jsx)(qt.a,{padding:2,children:Object(w.jsxs)(Gt.a,{container:!0,justify:"space-around",children:[Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:"auto",children:Object(w.jsx)(bt.a,{fullWidth:!0,clearable:!0,label:X("Performance.From"),value:N,onChange:function(e){return R(e)},maxDate:new Date,format:"dd/MM/yyyy"})}),Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:"auto",children:Object(w.jsx)(bt.a,{fullWidth:!0,clearable:!0,label:X("Performance.To"),value:$,onChange:function(e){return K(e)},maxDate:new Date,format:"dd/MM/yyyy"})}),Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:"auto",children:Object(w.jsxs)(y.a,{button:!0,onClick:function(){return G(!U)},children:[Object(w.jsx)(H.a,{children:U?Object(w.jsx)(mn.a,{color:"secondary"}):Object(w.jsx)(xn.a,{})}),Object(w.jsx)(C.a,{primary:X("Performance.NotPayed")})]})})]})})}),0===i.length&&Object(w.jsx)(st.a,{children:X("Performance.NoPerformance")}),Object(w.jsx)(g.a,{children:Object(w.jsx)(Vt.a,{dataLength:i.length,next:function(){return Z(Y+10)},hasMore:!0,children:i.map((function(e){var t=e._id;return Object(w.jsx)(l.Push,{href:"/performance/view/".concat(t),children:Object(w.jsx)(Qt,{performance:e,checked:!!b.find((function(e){return e._id===t})),onToggle:ee(e)})},t)}))})})]}),print:k?Object(w.jsx)(dn,Object(S.a)({list:b},A)):null})}};function gn(e){var t=e.performance,n=(e.print,ue()),c=Object(u.a)(n,1)[0],a=t.client,r=a.name,i=a.surname,o=t.discount,s=t.end,j=t.note,b=t.pauses,d=t.payed,O=t.payments,h=t.price,f=t.start,x=Re(f,s,b),p=x/1e3/3600*h,m=p-o,v=O.reduce((function(e,t){return e+t.value}),0),S=m-v;return Object(w.jsxs)(qt.a,{children:[Object(w.jsxs)(qt.a,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[Object(w.jsxs)(l.GrowTypography,{variant:"h4",children:[r," ",i]}),Object(w.jsxs)(qt.a,{display:"flex",alignItems:"center",children:[!!d&&Object(w.jsx)(H.a,{children:Object(w.jsx)(Ze.a,{color:"secondary"})}),Object(w.jsx)(C.a,{primary:Object(w.jsxs)(st.a,{variant:"h5",children:[parseFloat(m).toFixed(2)," ",c.currency]}),secondary:"Totale"})]})]}),Object(w.jsxs)(Gt.a,{container:!0,justify:"space-between",children:[Object(w.jsx)(Gt.a,{item:!0,xs:6,sm:"auto",children:Object(w.jsx)(C.a,{primary:new Date(f).toLocaleString(),secondary:"Inizio"})}),Object(w.jsx)(Gt.a,{item:!0,xs:6,sm:"auto",children:Object(w.jsx)(C.a,{primary:new Date(s).toLocaleString(),secondary:"Fine"})}),Object(w.jsx)(Gt.a,{item:!0,xs:6,sm:"auto",children:Object(w.jsx)(C.a,{primary:Me(x),secondary:"Durata"})})]}),!!j&&Object(w.jsxs)(qt.a,{mb:1,children:[Object(w.jsx)(st.a,{variant:"h6",children:"Note"}),j.split("\n").map((function(e,t){return Object(w.jsx)(st.a,{variant:"body2",color:"textSecondary",children:e},t)}))]}),Object(w.jsx)(st.a,{variant:"h6",children:"Riepilogo"}),Object(w.jsxs)(Gt.a,{container:!0,justify:"space-between",children:[Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(h).toFixed(2)," ").concat(c.currency,"/h"),secondary:"Tariffa"})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(p).toFixed(2)," ").concat(c.currency),secondary:"Costo"})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(o).toFixed(2)," ").concat(c.currency),secondary:"Sconto"})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(m).toFixed(2)," ").concat(c.currency),secondary:"Totale"})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(v).toFixed(2)," ").concat(c.currency),secondary:"Saldo"})}),Object(w.jsx)(Gt.a,{item:!0,xs:4,sm:3,md:"auto",children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(S).toFixed(2)," ").concat(c.currency),secondary:"Dovuto"})})]}),!!b&&0!==b.length&&Object(w.jsx)(g.a,{subheader:Object(w.jsx)(W.a,{children:"Pause"}),children:b.map((function(e,t){var n=e.end,c=(e.length,e.note),a=e.start;return Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:c,secondary:Me(Re(a,n))})},t)}))}),!!O&&0!==O.length&&Object(w.jsx)(g.a,{subheader:Object(w.jsx)(W.a,{children:"Pagamenti"}),children:O.map((function(e){var t=e.value,n=e.date;return Object(w.jsx)(y.a,{children:Object(w.jsx)(C.a,{primary:"".concat(parseFloat(t).toFixed(2)," ").concat(c.currency),secondary:new Date(n).toLocaleString()})},n)}))})]})}var yn={path:"/performance/view/:id",exact:!0,component:function(){var e=Object(E.m)().id,t=Object(_.useSnackbar)().enqueueSnackbar,n=Object(c.useState)(),a=Object(u.a)(n,2),r=a[0],i=a[1];if(Object(c.useEffect)((function(){(function(e){return new We(e).read()})(e).then((function(e){return i(e)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})}))}),[e,t]),!r)return Object(w.jsx)(Ee,{});var o=r._id;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:[Object(w.jsx)(B.a,{onClick:function(){window.print()},children:Object(w.jsx)(nn.a,{})},"print"),Object(w.jsx)(l.Push,{href:"/performance/edit/".concat(o),state:r,children:Object(w.jsx)(B.a,{children:Object(w.jsx)(et.a,{})})},"edit")],children:"Prestazione"}),content:Object(w.jsx)(l.Content,{children:Object(w.jsx)(gn,{performance:r})}),print:Object(w.jsx)(gn,{performance:r,print:!0})})}};var Cn={path:"/performance",component:function(){return D("Prestazioni"),Object(w.jsxs)(E.g,{children:[Object(w.jsx)(E.d,Object(S.a)({},Kt)),Object(w.jsx)(E.d,Object(S.a)({},vn)),Object(w.jsx)(E.d,Object(S.a)({},yn)),Object(w.jsx)(E.c,{to:"/notfound"})]})}},Sn={key:"performance",primary:"Performance.Key_plural",secondary:"",icon:Object(w.jsx)(ut.a,{}),title:"$t(Open) $t(Performance.Key_plural)"},kn=n(397),wn=n.n(kn),Pn=n(562),Tn=n(396),Dn=n.n(Tn);function An(e){var t=e.children,n=e.title,c=void 0===n?"":n;return Object(w.jsx)(H.a,{children:Object(w.jsx)(Pn.a,{arrow:!0,title:t||Object(w.jsx)(st.a,{variant:"body2",children:c}),children:Object(w.jsx)(Dn.a,{style:{cursor:"help"}})})})}var Fn={path:"/settings",exact:!0,component:function(){D("Impostazioni");var e=ue(),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(v.a)().t,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(a){var r=a.target.value;return c(Object(S.a)(Object(S.a)({},n),{},Object(N.a)({},e,t(r))))}},i=n.currency,o=n.discountRound,s=n.enableDiscountRound,j=n.price,b=n.printTitle,d=n.printBefore,O=n.printAfter,h=n.printNote;return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),children:a("Settings.Key")}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{subheader:Object(w.jsx)(W.a,{children:a("Settings.General")}),children:[Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.Price.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.Price.Key"),value:parseFloat(j||0).toFixed(2),onChange:r("price",parseFloat),InputProps:{startAdornment:Object(w.jsxs)(M.a,{position:"start",children:[i,"/h"]})}})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.Rounding.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.Rounding.Key"),onChange:r("discountRound",parseFloat),value:parseFloat(o||0).toFixed(2),disabled:!s,InputProps:{startAdornment:Object(w.jsx)(M.a,{position:"start",children:i}),endAdornment:Object(w.jsx)(M.a,{position:"end",children:Object(w.jsx)(zt.a,{checked:s,onChange:r("enableDiscountRound",(function(){return!s}))})})}})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.Currency.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.Currency.Key"),onChange:r("currency"),value:i})]})]}),Object(w.jsxs)(g.a,{subheader:Object(w.jsx)(W.a,{children:a("Settings.Print")}),children:[Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.PrintTitle.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.PrintTitle.Key"),onChange:r("printTitle"),value:b})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.PrintBefore.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.PrintBefore.Key"),onChange:r("printBefore"),value:d,multiline:!0,rows:2,rowsMax:4})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.PrintAfter.Tooltip")}),Object(w.jsx)(R.a,{fullWidth:!0,label:a("Settings.PrintAfter.Key"),onChange:r("printAfter"),value:O,multiline:!0,rows:2,rowsMax:4})]}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(An,{title:a("Settings.PrintNote.Tooltip")}),Object(w.jsx)(en.a,{control:Object(w.jsx)(zt.a,{checked:h,onChange:r("printNote",(function(){return!h}))}),label:a("Settings.PrintNote.Key")})]})]})]})})}},In={key:"settings",primary:"Settings.Key",secondary:"",icon:Object(w.jsx)(wn.a,{}),title:"$t(Open) $t(Settings.Key)"},En=n(171),Nn=n(568),_n=Object(c.createContext)();function Bn(){return Object(c.useContext)(_n)}function Rn(e){var t=e.children,n=e.defaultValue,a=Object(c.useState)(n);return Object(w.jsx)(_n.Provider,{value:a,children:t})}function Mn(){var e=Object(E.k)().push,t=Object(_.useSnackbar)().enqueueSnackbar,n=Object(v.a)().t,a=Bn(),r=Object(u.a)(a,2),i=r[0],o=r[1],s=(i||{}).client,j=Object(c.useState)([]),l=Object(u.a)(j,2),b=l[0],d=l[1],O=Object(c.useState)(!1),h=Object(u.a)(O,2),f=h[0],x=h[1],p=Object(c.useState)(""),m=Object(u.a)(p,2),g=m[0],y=m[1],C=Object(En.debounce)((function(e){var n=e.target.value;x(!0),y(n),we(n).then((function(e){return d(e)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})})).finally((function(){x(!1)}))}),250),k=function(){var t=g.split(" "),n=Object(u.a)(t,2),c=n[0],a=n[1];e("/client/create",{name:c,surname:a})};return Object(w.jsx)(Nn.a,{fullWidth:!0,freeSolo:!0,loading:f,options:b,getOptionLabel:function(e){var t=e._id,n=e.name,c=e.surname;return t?"".concat(n," ").concat(c):""},getOptionSelected:function(e,t){return e._id===t._id},value:s||null,onChange:function(e,t){return o((function(e){return Object(S.a)(Object(S.a)({},e),{},{client:t})}))},renderInput:function(e){return Object(w.jsx)(R.a,Object(S.a)(Object(S.a)({label:n("Client.Key"),fullWidth:!0,onChange:C},e),{},{InputProps:Object(S.a)(Object(S.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(c.Fragment,{children:[!s&&!!g&&Object(w.jsx)(B.a,{size:"small",onClick:k,children:Object(w.jsx)(re.a,{})}),e.InputProps.endAdornment]})})}))}})}var Ln=n(545),Wn=n(151),Hn=n.n(Wn);function $n(){var e=Object(E.k)().replace,t=Object(_.useSnackbar)().enqueueSnackbar,n=Object(v.a)().t,a=ue(),r=Object(u.a)(a,1)[0],i=Object(c.useState)(!1),o=Object(u.a)(i,2),s=o[0],j=o[1],b=Bn(),d=Object(u.a)(b,2),O=d[0],h=d[1],f=O||{},x=f.client,p=f.price,m=f.pause,g=f.pauses,y=f.start,C=f.status;return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(B.a,{color:"inherit",disabled:!C||"paused"!==C,onClick:function(){return j(!0)},children:Object(w.jsx)(Hn.a,{})},"_stop"),Object(w.jsxs)(ht.a,{open:s,onClose:function(){return j(!1)},children:[Object(w.jsx)(ft.a,{children:n("Tracker.Stop the tracker")}),Object(w.jsxs)(xt.a,{children:[Object(w.jsx)(Ln.a,{children:n("Tracker.Stop the tracker and save the performance")}),Object(w.jsx)(Ln.a,{children:n("Tracker.Discard current tracker")}),Object(w.jsx)(Ln.a,{children:n("Tracker.Cancel to not modify anything")})]}),Object(w.jsxs)(pt.a,{children:[Object(w.jsx)(Ct.a,{color:"primary",variant:"contained",onClick:function(){if(!x)return j(!1),t(n("Tracker.Snackbar.ClientNotSelected"),{variant:"warning"});if(isNaN(p)||p<0)return j(!1),t(n("Tracker.Snackbar.PriceNotValid"),{variant:"warning"});var c,a=Re(y,m.start,g)/1e3/3600*p,i=Object(S.a)(Object(S.a)({},O),{},{end:m.start,status:"stopped",payments:[],discount:r.enableDiscountRound?Le(a,r.discountRound):0});h(i),t(n("Tracker.Snackbar.Stopped"),{variant:"info"}),(c=$e(i),(new We).create(c)).then((function(c){var a=c.id;t(n("Tracker.Snackbar.Saved"),{variant:"success"}),setTimeout(e,500,"/performance/view/".concat(a)),h()})).catch((function(e){t(n("Error.Save"),{variant:"error"})}))},children:n("Save")}),Object(w.jsx)(l.DangerButton,{variant:"contained",onClick:function(){h({note:"",pause:null,pauses:[],price:r.price,start:null,status:null}),t(n("Tracker.Snackbar.Discarded"),{variant:"success"}),j(!1)},children:n("Delete")}),Object(w.jsx)(Ct.a,{onClick:function(){return j(!1)},children:n("Cancel")})]})]})]})}var Kn=n(196),zn=n.n(Kn);function qn(){var e=Object(_.useSnackbar)().enqueueSnackbar,t=Object(v.a)().t,n=Bn(),c=Object(u.a)(n,2),a=c[0],r=c[1],i=a||{},o=i.pause,s=i.pauses,j=i.status;return[Object(w.jsx)($n,{},"stop"),Object(w.jsx)(B.a,{color:"inherit",disabled:!j||"started"!==j,onClick:function(){r(Object(S.a)(Object(S.a)({},a),{},{status:"paused",pause:Ft()})),e(t("Tracker.Snackbar.Paused"),{variant:"info"})},children:Object(w.jsx)(zn.a,{})},"pause"),!!j&&Object(w.jsx)(B.a,{color:"inherit",disabled:"paused"!==j,onClick:function(){var n=new Date;r(Object(S.a)(Object(S.a)({},a),{},{status:"started",pauses:[Object(S.a)(Object(S.a)({},o),{},{end:n})].concat(Object(L.a)(s||[])),pause:null})),e(t("Tracker.Snackbar.Started"),{variant:"info"})},children:Object(w.jsx)(nt.a,{})},"resume"),!j&&Object(w.jsx)(B.a,{color:"inherit",onClick:function(){r(Object(S.a)(Object(S.a)({},a),{},{status:"started",start:new Date,pauses:[]})),e(t("Tracker.Snackbar.Started"),{variant:"info"})},children:Object(w.jsx)(nt.a,{})},"play")]}function Un(){var e=Bn(),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),i=Object(u.a)(r,2),o=i[0],s=i[1],j=Object(c.useState)(0),l=Object(u.a)(j,2),b=l[0],d=l[1],O=Object(c.useRef)(),h=(n||{}).status,f=o||{},x=f.note,p=f.start;if(Object(c.useEffect)((function(){s(n.pause),O&&O.current&&O.current.focus()}),[]),Object(c.useEffect)((function(){if("paused"===h){var e=setTimeout((function(){d(new Date-p)}),1e3);return function(){return clearTimeout(e)}}}),[b,p,h]),Object(c.useEffect)((function(){var e=setTimeout((function(){a(Object(S.a)(Object(S.a)({},n),{},{pause:o}))}),200);return function(){return clearTimeout(e)}}),[o]),"paused"!==h)return null;return Object(w.jsx)(R.a,{fullWidth:!0,label:Me(b),value:x||"",onChange:function(e){var t=e.target.value;s(Object(S.a)(Object(S.a)({},o),{},{note:t}))},inputRef:O})}function Gn(e){var t=e.index,n=Bn(),a=Object(u.a)(n,2),r=a[0],i=a[1],o=(r||{}).pauses,s=Object(c.useState)(o[t]),j=Object(u.a)(s,2),l=j[0],b=j[1],d=l.end,O=l.note,h=Re(l.start,d);Object(c.useEffect)((function(){var e=setTimeout((function(){var e=o.slice();e[t]=l,i(Object(S.a)(Object(S.a)({},r),{},{pauses:e}))}),200);return function(){return clearTimeout(e)}}),[l]);return Object(w.jsx)(R.a,{fullWidth:!0,label:Me(h),value:O,onChange:function(e){var t=e.target.value;return b(Object(S.a)(Object(S.a)({},l),{},{note:t}))}})}function Vn(){var e=Object(v.a)().t,t=Bn(),n=Object(u.a)(t,1)[0]||{pauses:[]},c=n.pauses,a=n.status,r=!(!c||!c.length);return Object(w.jsxs)(g.a,{subheader:(r||"paused"===a)&&Object(w.jsx)(W.a,{children:e("Pause")}),children:[!!a&&"paused"===a&&Object(w.jsx)(y.a,{children:Object(w.jsx)(Un,{})}),r&&c.map((function(e,t){var n=e.start;return Object(w.jsx)(y.a,{children:Object(w.jsx)(Gn,{index:t})},n)}))]})}function Jn(){var e=Object(v.a)().t,t=Bn(),n=Object(u.a)(t,1)[0],a=Object(c.useState)(new Date),r=Object(u.a)(a,2),i=r[0],o=r[1],s=n||{},j=s.start,l=s.status;Object(c.useEffect)((function(){if(!j){var e=setTimeout((function(){o(new Date)}),1e3);return function(){return clearTimeout(e)}}new Date(j)-new Date(i)!==0&&o(new Date(j))}),[i,j]);var b=Object(c.useMemo)((function(){return{started:Object(w.jsx)(nt.a,{}),paused:Object(w.jsx)(zn.a,{}),stopped:Object(w.jsx)(Hn.a,{})}[l]||Object(w.jsx)(Hn.a,{})}),[l]);return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(H.a,{children:b}),Object(w.jsx)(C.a,{primary:e("Tracker.Status.".concat(l||"stopped")),secondary:e("Status")}),Object(w.jsx)(C.a,{primary:new Date(i).toLocaleDateString(),secondary:e("Date")}),Object(w.jsx)(C.a,{primary:new Date(i).toLocaleTimeString(),secondary:e("Time")})]})}function Yn(){var e=Bn(),t=Object(u.a)(e,1)[0],n=Object(c.useState)("00:00:00"),a=Object(u.a)(n,2),r=a[0],i=a[1],o=t||{},s=o.pause,j=o.pauses,l=o.start,b=o.status;return Object(c.useEffect)((function(){if(l){if("started"===b){var e=setTimeout((function(){i(Me(Re(l,s?s.start:new Date,j)))}),1e3);return function(){return clearTimeout(e)}}}else i("00:00:00")}),[l,b,r]),r}var Zn={client:null,note:"",pause:null,pauses:[],price:0,start:null,status:null};var Xn={path:"/tracker",exact:!0,component:function(){D("Timer");var e=Object(E.l)().state,t=ue(),n=Object(u.a)(t,1)[0],a=Bn(),r=Object(u.a)(a,2),i=r[0],o=r[1],s=Object(c.useRef)(),j=i||{},b=j.client,d=j.note,O=j.pause,h=j.price,f=j.status;Object(c.useEffect)((function(){o(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return te.apply(void 0,[Zn].concat(t))}(i,{price:n.price},e))}),[]),Object(c.useEffect)((function(){b&&o(Object(S.a)(Object(S.a)({},i),{},{price:b.price}))}),[b]),Object(c.useEffect)((function(){"paused"===f&&s&&s.current&&s.current.focus()}),[f]);var x=O&&O.end;Object(c.useEffect)((function(){if(O){var e=setTimeout((function(){return o((function(e){return Object(S.a)(Object(S.a)({},e),{},{pause:Object(S.a)(Object(S.a)({},e.pause),{},{end:new Date})})}))}),1e3);return function(){return clearTimeout(e)}}}),[O,x,o]);var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return function(n){var c=n.target.value;o(Object(S.a)(Object(S.a)({},i),{},Object(N.a)({},e,t(c))))}};return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.BackIconButton,{}),rightAction:Object(w.jsx)(qn,{}),children:Object(w.jsx)(Yn,{})}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsxs)(g.a,{children:[Object(w.jsx)(y.a,{children:Object(w.jsx)(Jn,{})}),Object(w.jsxs)(y.a,{children:[Object(w.jsx)(Mn,{}),Object(w.jsx)(R.a,{fullWidth:!0,label:"Tariffa",type:"number",value:parseFloat(h||0).toFixed(2),onChange:p("price",parseFloat),InputProps:{startAdornment:Object(w.jsxs)(M.a,{position:"start",children:[n.currency,"/h"]})},inputProps:{min:0}})]}),Object(w.jsx)(y.a,{children:Object(w.jsx)(R.a,{fullWidth:!0,variant:"outlined",multiline:!0,rows:4,rowsMax:8,label:"Note",value:d,onChange:p("note")})})]}),Object(w.jsx)(Vn,{})]})})}},Qn={key:"tracker",primary:"Tracker.Key",secondary:"",icon:Object(w.jsx)(Ie.a,{}),title:"$t(Open) $t(Tracker.Key)"};function ec(e){var t=e.href,n=e.icon,c=Object(Ot.a)(e,["href","icon"]);return Object(w.jsx)(Gt.a,{item:!0,xs:12,sm:"auto",children:Object(w.jsx)(l.Push,{href:t,children:Object(w.jsxs)(y.a,{button:!0,children:[!!n&&Object(w.jsx)(H.a,{children:n}),Object(w.jsx)(C.a,Object(S.a)({},c))]})})})}function tc(e){var t=e.Item,n=void 0===t?ec:t,c=e.Icon,a=e.list,r=e.title,i=e.alt;return a?Object(w.jsx)(qt.a,{mb:2,children:Object(w.jsxs)(Gt.a,{container:!0,children:[Object(w.jsx)(Gt.a,{item:!0,xs:12,children:Object(w.jsxs)(st.a,{variant:"h6",children:[r," ",a.length>0?"(".concat(a.length,")"):""]})}),Object(w.jsxs)(Gt.a,{item:!0,xs:12,container:!0,children:[0===a.length?i:"",a.map((function(e){return Object(w.jsx)(n,Object(S.a)({icon:c?Object(w.jsx)(c,{}):Object(w.jsx)("span",{})},e))}))]})]})}):null}var nc=n(398),cc=n.n(nc);var ac={path:"/",exact:!0,component:function(){D();var e=Object(E.k)().push,t=Object(_.useSnackbar)().enqueueSnackbar,n=Bn(),a=(Object(u.a)(n,1)[0]||{}).status,r=Object(c.useState)(),i=Object(u.a)(r,2),o=i[0],s=i[1],j=Object(c.useState)(),b=Object(u.a)(j,2),d=b[0],O=b[1],h=Object(c.useState)(!1),f=Object(u.a)(h,2),x=f[0],p=f[1],m=Object(v.a)().t;Object(c.useEffect)((function(){x||(p(!0),Promise.all([Pe(),Je({})]).then((function(e){var t=Object(u.a)(e,2),n=t[0],c=t[1];s(n),O(c)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})})))}),[x]);var g=Object(c.useMemo)((function(){return a?Object(w.jsx)(cc.a,{color:"secondary"}):Object(w.jsx)(Ie.a,{})}),[a]);return Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:[Object(w.jsx)(l.DrawerIconButton,{color:"inherit",children:Object(w.jsx)(l.DrawerLists,{lists:[{key:"pages",items:[Object(S.a)(Object(S.a)({onClick:function(){return e("/tracker")}},Qn),{},{primary:m(Qn.primary),title:m(Qn.title),secondary:m("Tracker.Status.".concat(a)),icon:g}),Object(S.a)(Object(S.a)({onClick:function(){return e("/client")}},ot),{},{primary:m(ot.primary),title:m(ot.title)}),Object(S.a)(Object(S.a)({onClick:function(){return e("/performance")}},Sn),{},{primary:m(Sn.primary),title:m(Sn.title)})]},{key:"app",items:[Object(S.a)(Object(S.a)({onClick:function(){return e("/about")}},I),{},{primary:m(I.primary),title:m(I.title)}),Object(S.a)(Object(S.a)({onClick:function(){return e("/settings")}},In),{},{primary:m(In.primary),title:m(In.title)})]}]})},"drawer"),Object(w.jsx)(l.HeaderSearchField,{fullWidth:!0,placeholder:m("Search"),onSearch:function(e,n){var c;""===n?p(!1):(p(!0),(c=n,Promise.all([we(c),Ve(c)])).then((function(e){var t=Object(u.a)(e,2),n=t[0],c=t[1];s(n),O(c)})).catch((function(e){console.error(e),t("".concat(e.name," ").concat(e.message),{variant:"error"})})))},onClear:function(){p(!1)}},"search")],rightAction:Object(w.jsx)(l.Push,{href:"/tracker",children:Object(w.jsx)(B.a,{color:"inherit",children:g})})}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsx)(tc,{title:m("Client.Key",{count:o?o.length:0}),Icon:rt.a,list:!!o&&o.map((function(e){var t=e._id,n=e.name,c=e.surname,a=e.contacts;return{_id:t,key:t,primary:"".concat(n," ").concat(c),secondary:a&&a.length?a[0].value:"",href:"/client/view/".concat(t)}})),alt:Object(w.jsx)(st.a,{children:m("Client.NoClient")})}),Object(w.jsx)(tc,{title:m("Performance.Key",{count:d?d.length:0}),Icon:ut.a,list:!!d&&d.map((function(e){var t=e._id,n=e.client,c=n.name,a=n.surname,r=e.note,i=e.start;return{_id:t,key:t,primary:"".concat(c," ").concat(a," - ").concat(new Date(i).toLocaleString()),secondary:r,href:"/performance/view/".concat(t)}})),alt:Object(w.jsx)(st.a,{children:m("Performance.NoPerformance")})})]})})}},rc=n(253),ic=n.n(rc);var oc={path:"/notfound",exact:!0,component:function(){var e=Object(v.a)().t;return D("404 ".concat(e("Page Not Found"))),Object(w.jsx)(l.Page,{header:Object(w.jsx)(l.Header,{leftAction:Object(w.jsx)(l.Push,{replace:!0,href:"/",children:Object(w.jsx)(B.a,{children:Object(w.jsx)(ic.a,{})})}),children:e("Page Not Found")}),content:Object(w.jsxs)(l.Content,{children:[Object(w.jsx)(st.a,{paragraph:!0,children:e("NotFound.Content")}),Object(w.jsx)(g.a,{children:Object(w.jsx)(l.Push,{href:"/",replace:!0,children:Object(w.jsxs)(y.a,{button:!0,children:[Object(w.jsx)(H.a,{children:Object(w.jsx)(ic.a,{})}),Object(w.jsx)(C.a,{primary:"Dashboard",secondary:e("NotFound.Back to Dashboard")})]})})})]})})}},sc=n(549),jc=n(172);function uc(e){var t=e.Component,n=Object(Ot.a)(e,["Component"]),a=Object(c.useMemo)((function(){return Object(jc.a)(t)((function(){return{width:"100vw",height:"100vh"}}))}),[t]);return Object(w.jsx)(a,Object(S.a)({},n))}var lc=Object(jc.a)(Ut.a)((function(e){var t=e.theme;return{background:t.palette.primary.main,color:t.palette.getContrastText(t.palette.primary.main)}}));function bc(e){return Object(w.jsx)(lc,Object(S.a)({},e))}function dc(e){var t=e.children;return Object(w.jsx)(bc,{square:!0,elevation:0,children:Object(w.jsx)(uc,{Component:Gt.a,container:!0,alignItems:"center",justify:"center",alignContent:"center",children:Object(w.jsx)(Gt.a,{item:!0,children:t})})})}function Oc(e){var t=e.children;return e.loading?Object(w.jsxs)(dc,{children:[Object(w.jsx)(st.a,{variant:"h3",children:"Loading"}),Object(w.jsx)(sc.a,{variant:"indeterminate",color:"secondary"})]}):t}function hc(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(d.a)("(prefers-color-scheme: dark)");return Object(c.useEffect)((function(){if(!n){function e(){return(e=Object(j.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce();case 2:return e.next=4,qe();case 4:a(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}}),[n]),Object(w.jsx)(l.AppContainer,{ThemeProps:{palette:{primary:h.a,secondary:x.a,type:r?"dark":"light"}},RouterProps:{Router:b.BrowserRouter,routes:[F,it,ac,oc,Cn,Fn,Xn],basename:"/klepsydra"},WrapperProps:{Children:[{Component:Oc,loading:!n},{Component:le},{Component:Rn},{Component:m.a,utils:p.a}]},NotifyProps:{anchorOrigin:{vertical:"bottom",horizontal:"center"}},ConfigProps:{TopFab:{color:"secondary",size:"small"}}})}var fc=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,573)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},xc=n(405),pc=n(407),mc=n(408),vc=n(152),gc=n(406),yc=n(402),Cc=n(403);xc.a.use(pc.a).use(mc.a).use(vc.e).init({fallbackLng:"en",backend:{backends:[gc.a,yc.a],backendOptions:[Object(S.a)({prefix:"i18next_res_",expirationTime:6048e5,defaultVersion:A.a},Cc.a),{loadPath:"/klepsydra/locales/{{lng}}/{{ns}}.json"}]}}),i.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(hc,{})}),document.getElementById("root")),fc()}},[[508,1,2]]]);
//# sourceMappingURL=main.6bb559b1.chunk.js.map